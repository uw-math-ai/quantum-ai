import stim

# The stabilizers that failed
failed_stabs = [
    "IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXIIIIIIIIIIIIIIIIIIIII",
    "IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXIIIIXXXIIIIIIIIIIIXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXIIII",
    "IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZIIIIZZZIIIIIIIIIIIZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZIIII"
]

# Load circuit
with open("circuit_133.stim", "r") as f:
    c = stim.Circuit(f.read())

sim = stim.TableauSimulator()
sim.do(c)

print("Checking failed stabilizers locally:")
for s_str in failed_stabs:
    s = stim.PauliString(s_str)
    res = sim.peek_observable_expectation(s)
    print(f"{s_str}: {res}")
