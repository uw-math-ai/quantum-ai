import stim

def generate_stabilizers():
    stabilizers = []
    
    # Pattern 1: XZZX shifted by 5
    for i in range(25):
        s = ["I"] * 125
        start = 5 * i
        if start + 4 <= 125:
            s[start] = "X"
            s[start+1] = "Z"
            s[start+2] = "Z"
            s[start+3] = "X"
            stabilizers.append("".join(s))
        else:
            print(f"Pattern 1 overflow at index {i}")

    # Pattern 2: XIXZZ shifted by 5
    for i in range(25):
        s = ["I"] * 125
        start = 5 * i
        if start + 5 <= 125:
            s[start] = "X"
            s[start+1] = "I"
            s[start+2] = "X"
            s[start+3] = "Z"
            s[start+4] = "Z"
            stabilizers.append("".join(s))
        else:
            print(f"Pattern 2 overflow at index {i}")

    # Pattern 3: ZXIXZ shifted by 5
    for i in range(25):
        s = ["I"] * 125
        start = 5 * i
        if start + 5 <= 125:
            s[start] = "Z"
            s[start+1] = "X"
            s[start+2] = "I"
            s[start+3] = "X"
            s[start+4] = "Z"
            stabilizers.append("".join(s))
        else:
            print(f"Pattern 3 overflow at index {i}")
            
    return stabilizers

# Block 4 from prompt
block4_raw = [
"XXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIII",
"IIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXXXXXXIIIIIIIIIIIIIIIXXXXXXXXXX",
"IIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIIIXXXXXIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIII",
"IIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIII",
"IIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIII",
"ZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZIIIIIIIIII",
"IIIIIIIIIIZZZZZZZZZZIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII",
"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIZZZZZZZZZZ"
]

stabilizers = generate_stabilizers()
for s in block4_raw:
    stabilizers.append(s)

print(f"Total stabilizers: {len(stabilizers)}")

# Verify lengths
for i, s in enumerate(stabilizers):
    if len(s) != 125:
        print(f"Error: Stabilizer {i} has length {len(s)}")

# Check commutativity
stim_stabilizers = []
for s in stabilizers:
    stim_stabilizers.append(stim.PauliString(s))

commutes = True
for i in range(len(stim_stabilizers)):
    for j in range(i + 1, len(stim_stabilizers)):
        if not stim_stabilizers[i].commutes(stim_stabilizers[j]):
            print(f"Stabilizers {i} and {j} anticommute!")
            commutes = False
if commutes:
    print("All stabilizers commute!")

t = stim.Tableau.from_stabilizers(stim_stabilizers, allow_redundant=True, allow_underconstrained=True)
# print(f"Tableau created. num_qubits={t.num_qubits}, rank={len(t)}")

circuit = t.to_circuit("elimination")
print("Circuit generated (naive). Operations count:", len(circuit))

# Save the circuit to a file to check with the tool
with open("data/gemini-3-pro-preview/agent_files/circuit_candidate.stim", "w") as f:
    f.write(str(circuit))
